

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cjf.cmap.util.gct_utils &mdash; CJF-CMAP 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/theme_extras.js"></script>
    <link rel="top" title="CJF-CMAP 1.1 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
      <div class="header"><img class="rightlogo" src="../../../../_static/CJF2.png" alt="Logo"/><h1 class="heading"><a href="../../../../index.html">
          <span>CJF-CMAP 1.1 documentation</span></a></h1>
        <h2 class="heading"><span>cjf.cmap.util.gct_utils</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for cjf.cmap.util.gct_utils</h1><div class="highlight"><pre>
<span class="c">#! usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Utility functions related to handling gct files</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
    
<div class="viewcode-block" id="gct_13_to_12"><a class="viewcode-back" href="../../../../gct_utils.html#cjf.cmap.util.gct_utils.gct_13_to_12">[docs]</a><span class="k">def</span> <span class="nf">gct_13_to_12</span><span class="p">(</span><span class="n">version13File</span><span class="p">,</span><span class="n">version12File</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    gct_13_to_12 reverts a version 1.3 .gct file to a 1.2 .gct file compatible for use with utilities</span>
<span class="sd">    that are not updated for use with version 1.3 files.</span>

<span class="sd">    USAGE:</span>
<span class="sd">    gct_13_to_12(version13File,version12FileLocation)</span>

<span class="sd">    INPUT VARIABLES:</span>
<span class="sd">    version13File: the version 1.3 .gct file to convert</span>
<span class="sd">    version12File: the path to which the version 1.2 .gct file will be written</span>

<span class="sd">    Author: Corey Flynn, Broad institute, 2011</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#parse the input arguments</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">inputFilePath</span> <span class="o">=</span> <span class="n">version13File</span>
        <span class="n">f</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">inputFilePath</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">outputFilePath</span>  <span class="o">=</span> <span class="n">version12File</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputFilePath</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
    <span class="c">#read the input file header</span>
    <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

    <span class="c">#split the dims line </span>
    <span class="n">dimsList</span> <span class="o">=</span> <span class="n">dims</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>

    <span class="c">#write the new header lines to the output file</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;#1.2</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dimsList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span><span class="n">dimsList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="n">lineList</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lineList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">lineList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">lineList</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">dimsList</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">::]:</span>
        <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
    

    <span class="c">#skip all annotation lines in the file</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dimsList</span><span class="p">[</span><span class="mi">3</span><span class="p">])):</span> <span class="c">#@UnusedVariable</span>
        <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

    <span class="c">#finish writing the file with the 1.3 data</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">xreadlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">lineList</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lineList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">lineList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">lineList</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">dimsList</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">::]:</span>
            <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="update_to_parse_gct2"><a class="viewcode-back" href="../../../../gct_utils.html#cjf.cmap.util.gct_utils.update_to_parse_gct2">[docs]</a><span class="k">def</span> <span class="nf">update_to_parse_gct2</span><span class="p">(</span><span class="n">inputDirectory</span><span class="p">,</span><span class="n">outputDirectory</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function to update matlab files containing references to parse_gct and its produced fields to files</span>
<span class="sd">    that use parse_gct2 and its produced fields.</span>

<span class="sd">     USAGE:</span>
<span class="sd">     update_to_parse_gct2(inputDirectory,outputDirectory)</span>

<span class="sd">     VARIABLE DEFINITIONS:</span>
<span class="sd">     inputFilePath: the path to the directory of .m files to be operated on</span>
<span class="sd">     outputFilePath: the path to directory to be written to</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#imports</span>
    <span class="kn">import</span> <span class="nn">os</span>

    <span class="c">#parse the input arguments</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">inputDirectory</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">)</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">)</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c">#for all files in the input directory, read the lines in the input file and replace it with the following</span>
    <span class="c">#ge-&gt;mat</span>
    <span class="c">#gn-&gt;rid</span>
    <span class="c">#sid-&gt;cid</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">&#39;.m&#39;</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">print</span> <span class="p">(</span><span class="s">&#39;updating &#39;</span><span class="o">+</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">inputDirectory</span> <span class="o">+</span> <span class="n">f</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputDirectory</span> <span class="o">+</span> <span class="n">f</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">xreadlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;parse_gct&#39;</span><span class="p">,</span><span class="s">&#39;parse_gct2&#39;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ge&#39;</span><span class="p">,</span><span class="s">&#39;.mat&#39;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.gn&#39;</span><span class="p">,</span><span class="s">&#39;.rid&#39;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.sid&#39;</span><span class="p">,</span><span class="s">&#39;.cid&#39;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;mkgct&#39;</span><span class="p">,</span><span class="s">&#39;mkgct2&#39;</span><span class="p">)</span>
                <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">f2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="txt_to_gct_12"><a class="viewcode-back" href="../../../../gct_utils.html#cjf.cmap.util.gct_utils.txt_to_gct_12">[docs]</a><span class="k">def</span> <span class="nf">txt_to_gct_12</span><span class="p">(</span><span class="n">inputFilePath</span><span class="p">,</span><span class="n">outputFilePath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    txt_to_gct_12 converts a data file in txt format to one in gct version 1.2 format.  file formats can</span>
<span class="sd">    be viewed at (http://www.broadinstitute.org/cancer/software/genepattern/tutorial/gp_fileformats.html)</span>

<span class="sd">    USAGE:</span>
<span class="sd">    txt_to_gct_12 inputFile outputFile</span>

<span class="sd">    INPUT VARIABLES:</span>
<span class="sd">    inputFile: the .txt file to be converted</span>
<span class="sd">    outputFile: the .gct file tobe written</span>

<span class="sd">    NOTES:</span>
<span class="sd">    this script is a command line wrapper around gctUtils.txt_to_gct_12</span>

<span class="sd">    Author: Corey Flynn, Broad institute, 2011</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#parse the input arguments</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">inputFilePath</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputFilePath</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
    <span class="c">#find out the number of columns and rows in the input file</span>
    <span class="n">numRows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">inputFilePath</span><span class="p">):</span>
        <span class="n">numRows</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">firstLine</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="n">numColumns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstLine</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">))</span>
    
    <span class="c">#write the output file header</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;#1.2</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numRows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numColumns</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    
    <span class="c">#write the input file data to the output file</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">firstLine</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">))</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">xreadlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">))</span>
    
    <span class="c">#close the files</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;main&quot;</span><span class="p">:</span>
    <span class="k">pass</span>
    
    
</pre></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, Corey Flynn.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>